!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e,r){return function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r,n,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var o=[],i=!0,s=!1;try{for(a=a.call(t);!(i=(r=a.next()).done)&&(o.push(r.value),!e||o.length!==e);i=!0);}catch(t){s=!0,n=t}finally{try{i||null==a.return||a.return()}finally{if(s)throw n}}return o}}(e,r)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}}(e,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r,n={},a=new((r=function(){var t;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.boardSize=4,this.board=t||this.createEmptyBoard(),this.score=0,this.status="idle"}return t=[{key:"createEmptyBoard",value:function(){var t=this;return Array(this.boardSize).fill().map(function(){return Array(t.boardSize).fill(0)})}},{key:"getState",value:function(){return this.board}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}},{key:"restart",value:function(){this.start()}},{key:"addRandomTile",value:function(){for(var t=[],r=0;r<this.boardSize;r++)for(var n=0;n<this.boardSize;n++)0===this.board[r][n]&&t.push([r,n]);if(t.length>0){var a=e(t[Math.floor(Math.random()*t.length)],2),o=a[0],i=a[1];this.board[o][i]=.9>Math.random()?2:4}}},{key:"slide",value:function(t){for(var e=t.filter(function(t){return 0!==t}),r=[];e.length>0;)e.length>1&&e[0]===e[1]?(r.push(2*e[0]),this.score+=2*e[0],e.splice(0,2)):(r.push(e[0]),e.splice(0,1));for(;r.length<this.boardSize;)r.push(0);return r}},{key:"moveLeft",value:function(){var t=this,e=JSON.stringify(this.board);this.board=this.board.map(function(e){return t.slide(e)}),JSON.stringify(this.board)!==e&&(this.addRandomTile(),this.checkGameState())}},{key:"moveRight",value:function(){var t=this,e=JSON.stringify(this.board);this.board=this.board.map(function(e){return t.slide(e.reverse()).reverse()}),JSON.stringify(this.board)!==e&&(this.addRandomTile(),this.checkGameState())}},{key:"moveUp",value:function(){this.transposeBoard(),this.moveLeft(),this.transposeBoard()}},{key:"moveDown",value:function(){this.transposeBoard(),this.moveRight(),this.transposeBoard()}},{key:"transposeBoard",value:function(){var t=this;this.board=this.board[0].map(function(e,r){return t.board.map(function(t){return t[r]})})}},{key:"checkGameState",value:function(){this.board.flat().includes(2048)?this.status="win":this.canMove()||(this.status="lose")}},{key:"canMove",value:function(){if(this.board.flat().includes(0))return!0;for(var t=0;t<this.boardSize;t++)for(var e=0;e<this.boardSize-1;e++)if(this.board[t][e]===this.board[t][e+1])return!0;for(var r=0;r<this.boardSize;r++)for(var n=0;n<this.boardSize-1;n++)if(this.board[n][r]===this.board[n+1][r])return!0;return!1}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(r.prototype,t),r}())&&r.__esModule?r.default:r),o=document.querySelector(".game-field"),i=document.querySelector(".game-score"),s=document.querySelector("#ButtonStart"),u={start:document.querySelector(".message-start"),win:document.querySelector(".message-win"),lose:document.querySelector(".message-lose")};function l(){var t=a.getState();o.querySelectorAll(".field-cell").forEach(function(r){var n=e(r.dataset.position.split("-").map(Number),2),a=n[0],o=n[1],i=t[a][o];r.textContent=i>0?i:"",r.className="field-cell ".concat(i>0?"field-cell--".concat(i):"")}),i.textContent=a.getScore()}function c(t){Object.values(u).forEach(function(t){return t.classList.add("hidden")}),u[t].classList.remove("hidden")}s.addEventListener("click",function(){a.start(),l(),c(""),s.textContent="Restart"}),document.addEventListener("keydown",function(t){var e;return e=t.key,void("playing"===a.getStatus()&&("ArrowLeft"===e&&a.moveLeft(),"ArrowRight"===e&&a.moveRight(),"ArrowUp"===e&&a.moveUp(),"ArrowDown"===e&&a.moveDown(),l(),"win"===a.getStatus()&&c("win"),"lose"===a.getStatus()&&c("lose")))})}();
//# sourceMappingURL=index.ac8e5a3b.js.map
