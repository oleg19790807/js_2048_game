var t,e={};const s=new((t=class{constructor(t=null){this.boardSize=4,this.board=t||this.createEmptyBoard(),this.score=0,this.status="idle"}createEmptyBoard(){return Array(this.boardSize).fill().map(()=>Array(this.boardSize).fill(0))}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}start(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.start()}addRandomTile(){let t=[];for(let e=0;e<this.boardSize;e++)for(let s=0;s<this.boardSize;s++)0===this.board[e][s]&&t.push([e,s]);if(t.length>0){let[e,s]=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}slide(t){let e=t.filter(t=>0!==t),s=[];for(;e.length>0;)e.length>1&&e[0]===e[1]?(s.push(2*e[0]),this.score+=2*e[0],e.splice(0,2)):(s.push(e[0]),e.splice(0,1));for(;s.length<this.boardSize;)s.push(0);return s}moveLeft(){let t=JSON.stringify(this.board);this.board=this.board.map(t=>this.slide(t)),JSON.stringify(this.board)!==t&&(this.addRandomTile(),this.checkGameState())}moveRight(){let t=JSON.stringify(this.board);this.board=this.board.map(t=>this.slide(t.reverse()).reverse()),JSON.stringify(this.board)!==t&&(this.addRandomTile(),this.checkGameState())}moveUp(){this.transposeBoard(),this.moveLeft(),this.transposeBoard()}moveDown(){this.transposeBoard(),this.moveRight(),this.transposeBoard()}transposeBoard(){this.board=this.board[0].map((t,e)=>this.board.map(t=>t[e]))}checkGameState(){this.board.flat().includes(2048)?this.status="win":this.canMove()||(this.status="lose")}canMove(){if(this.board.flat().includes(0))return!0;for(let t=0;t<this.boardSize;t++)for(let e=0;e<this.boardSize-1;e++)if(this.board[t][e]===this.board[t][e+1])return!0;for(let t=0;t<this.boardSize;t++)for(let e=0;e<this.boardSize-1;e++)if(this.board[e][t]===this.board[e+1][t])return!0;return!1}}).__esModule?t.default:t),r=document.querySelector(".game-field"),i=document.querySelector(".game-score"),o=document.querySelector("#ButtonStart"),a={start:document.querySelector(".message-start"),win:document.querySelector(".message-win"),lose:document.querySelector(".message-lose")};function d(){let t=s.getState();r.querySelectorAll(".field-cell").forEach(e=>{let[s,r]=e.dataset.position.split("-").map(Number),i=t[s][r];e.textContent=i>0?i:"",e.className=`field-cell ${i>0?`field-cell--${i}`:""}`}),i.textContent=s.getScore()}function h(t){Object.values(a).forEach(t=>t.classList.add("hidden")),a[t].classList.remove("hidden")}o.addEventListener("click",()=>{s.start(),d(),h(""),o.textContent="Restart"}),document.addEventListener("keydown",t=>{var e;return e=t.key,void("playing"===s.getStatus()&&("ArrowLeft"===e&&s.moveLeft(),"ArrowRight"===e&&s.moveRight(),"ArrowUp"===e&&s.moveUp(),"ArrowDown"===e&&s.moveDown(),d(),"win"===s.getStatus()&&h("win"),"lose"===s.getStatus()&&h("lose")))});
//# sourceMappingURL=index.359199cf.js.map
